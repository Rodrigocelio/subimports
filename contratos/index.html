<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formul√°rio de Cliente</title>
    <link rel="stylesheet" href="style.css"> <!-- Link para o arquivo CSS -->
</head>
<body>
    <div class="container">
        <h2>STEP1 - INFORMA√á√ïES SOBRE O CLIENTE</h2>
        
        <form id="form-cliente">
            <label for="id-cliente">ID Cliente</label>
            <input type="text" id="id-cliente" placeholder="Digite o ID" required>

            <button type="button" class="btn" id="buscar">üîç Buscar</button>

            <label for="nome">Nome</label>
            <input type="text" id="nome" placeholder="Digite o nome" required>

            <label for="email">Email</label>
            <input type="text" id="email" placeholder="Digite o email" required>

            <label for="cpf">CPF</label>
            <input type="text" id="cpf" placeholder="Digite o CPF" required>
        </form>
    </div>

    <script>
        // URL da API e API Key para autentica√ß√£o
        const apiUrl = 'https://api.bling.com.br/Api/v3/contatos';
        const apiKey = '706dfb6d84b759ae9e9bfad909cb44c0218211230289489f0bf71926c32b';

        // Fun√ß√£o para buscar dados do cliente pela API
        async function buscarCliente(idCliente) {
            try {
                const response = await fetch(`${apiUrl}/${idCliente}`, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'apikey': apiKey // Adicionando a apikey no cabe√ßalho
                    },
                });

                if (!response.ok) {
                    throw new Error(`Erro ao buscar cliente: ${response.statusText}`);
                }

                const data = await response.json();
                
                // Extraindo os dados do cliente
                const cliente = {
                    id: data.retorno.contatos[0].contato.id,
                    nome: data.retorno.contatos[0].contato.nome,
                    numeroDocumento: data.retorno.contatos[0].contato.numeroDocumento,
                    email: data.retorno.contatos[0].contato.email,
                };

                return cliente;

            } catch (error) {
                console.error(error);
                alert("Erro ao buscar o cliente. Verifique o console para mais detalhes.");
                return null;
            }
        }

        // Evento para buscar o cliente ao clicar no bot√£o
        document.getElementById('buscar').addEventListener('click', async function() {
            const idCliente = document.getElementById('id-cliente').value.trim();
            
            if (idCliente === "") {
                alert("Por favor, insira um ID de Cliente v√°lido.");
                return;
            }

            const cliente = await buscarCliente(idCliente);
            if (cliente) {
                // Preencher os campos com os dados retornados da API
                document.getElementById('nome').value = cliente.nome;
                document.getElementById('email').value = cliente.email;
                document.getElementById('cpf').value = cliente.numeroDocumento;
            }
        });
    </script>
</body>
</html>
